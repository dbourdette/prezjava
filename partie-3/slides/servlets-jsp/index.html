<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1">
        <title>Servlets et Java Server Pages</title>

        <link href="../../../common/css/css.css" rel="stylesheet" type="text/css">
        <link href="../../../common/css/prettify.css" rel="stylesheet" id="prettify-link">
        <link href="../../../common/css/moon.css" class="theme" rel="stylesheet">
        <link href="../../../common/css/default.css" class="theme" rel="stylesheet">
        <link href="../../../common/css/dev.css" class="theme" rel="stylesheet">

        <script src="../../../common/jquery/jquery-1.4.4.min.js"></script>
        <script src="../../../common/jquery/jquery-ui-1.8.7.custom.min.js"></script>

        <script src="../../../common/js/code.js"></script>
        <script src="../../../common/js/prettify.js" onload="prettyPrint();"></script>

  	</head>
  	<body>
    <div class="presentation">
      <div id="presentation-counter">Chargement...</div>
      <div style="display: block;" class="slides">
      
	      <div class="slide">
			<style>
			  #landing-slide p {
			    font-size: 35px;
			  }
			</style>
			<section id="landing-slide" class="middle">
			  <p>Servlets et Java Server Pages</p>
			</section>
	      </div>
	
	      <div class="slide">
	      	<header>Le protocole HTTP en objets</header>
	        <section>
		       <p>Les objets centraux du package <b>javax.servlet.http</b> sont une correspondance directe des concepts et protocoles.</p>
		       <table class="refTable">
	         		<thead>
	        			<tr>
	        				<td>classe</td>
	        				<td>utilisation</td>
	        			</tr>
	        		</thead>
	        		<colgroup style="width:200px;">
	        		<tr>
	        			<td>HttpServletRequest</td>
	        			<td>La requête HTTP : path, paramètres, body...</td>
	        		</tr>
	        		<tr>
	        			<td>HttpServletResponse</td>
	        			<td>La réponse HTTP : écriture de la réponse, des headers, des cookies...</td>
	        		</tr>
	        		<tr>
	        			<td>Cookie</td>
	        			<td>Une paire clé / valeur (+ maxAge, path, domain, secure).</td>
	        		</tr>
	        	</table>
	        	<p>Et les composants jee qui les manipulent.</p>
	        	<table class="refTable">
	         		<thead>
	        			<tr>
	        				<td>classe</td>
	        				<td>utilisation</td>
	        			</tr>
	        		</thead>
	        		<colgroup style="width:200px;">
	        		<tr>
	        			<td>HttpServletContext</td>
	        			<td>Le context d'éxecution des servlets contenant la configuration.</td>
	        		</tr>
	        		<tr>
	        			<td>HttpServlet</td>
	        			<td>Le composant de base capable de gérer des requêtes et de générer une réponse.</td>
	        		</tr>
	        		<tr>
	        			<td>HttpSession</td>
	        			<td>Une session afin de stoquer des données. Le suivi de la session se fait via un cookie jsessionid.</td>
	        		</tr>
	        		<tr>
	        			<td>Filter</td>
	        			<td>La possibilité d'intercepter les requêtes avant qu'elle arrivent aux servlets.</td>
	        		</tr>
	        	</table>
	        </section>
	      </div>
	
	      <div class="slide">
	      	<header>Les servlets</header>
	        <section>
	        	<p>L'api de la classe HttpServlet possède les méthodes suivantes</p>
	        	<pre>
init(ServletConfig config)

destroy()

doGet(HttpServletRequest req, HttpServletResponse resp)

doPost(HttpServletRequest req, HttpServletResponse resp)

doPut(HttpServletRequest req, HttpServletResponse resp)

doDelete(HttpServletRequest req, HttpServletResponse resp)
 
doHead(HttpServletRequest req, HttpServletResponse resp)

doOptions(HttpServletRequest req, HttpServletResponse resp)

doTrace(HttpServletRequest req, HttpServletResponse resp)</pre>
				<p>La servlet propose un mapping complet des méthodes HTTP.</p>
				<p>En pratique, seuls doGet et doPost servent généralement.</p>
	        </section>
	      </div>
	
	      <div class="slide">
	      	<header>Redirect vs Forward</header>
	        <section>
	        	<p>Une servlet peut écrire dans la réponse et redonner la main au conteneur qui va finir la négociation avec le client.</p>
	        	<p>Si la servlet souhaite passer la main à un autre composant, il existe 2 méthodes :</p>
	        	<ul>
	        		<li>Redirect : le serveur rend la main au client en lui envoyant un code 301 ou 302 afin que le client fasse une autre requête vers une autre url.
	        		<li>Forward : la servlet passe la main à un autre composant en interne du serveur sans que le client puisse le voir.
	        	</ul>
	        	<p>Le forward sert notamment lorsqu'une servlet souhaite passer la main à un fichier jsp.</p>
	        </section>
	      </div>
	      
	      <div class="slide">
	      	<header>Les fichiers jsp</header>
	        <section>
	         	<p>Les fichiers jsp sont le moteur de templating des conteneurs de servlets.</p>
	          	<pre>
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
   &lt;head&gt;&lt;/head&gt;
   &lt;body&gt;
      Hello ${name} !&lt;br&gt;
      Hello &lt%=name%&gt; !&lt;br&gt;
   &lt;/body&gt;
&lt;/html&gt;</pre>
				<p>Ils disposent de mécaniques puissantes afin de créer le rendu html pour une page web.</p>
				<p>Ils peuvent également générer n'importe quel type de contenu textuel, comme du XML par exemple.</p>
				<p>Les jsp sont compilées en servlet au moment de leur interprétation, avant d'être exécutées.</p>
	        </section>
	      </div>
	      
	      <div class="slide">
	      	<header>Les directives jsp</header>
	        <section>
	        	<p>Les directives contrôlent la manière dont le compilateur doit générer la servlet.</p>
	        	<p>Le format d'une directive est le suivant.</p>
	            <pre>&lt;%@ directive { attribut="valeur" } %&gt;</pre>
	            <p>Par exemple afin de contrôler le mime type et l'encoding de la page.</p>
	            <pre>&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
	            				 pageEncoding="UTF-8"%&gt;</pre>
	           	<p>Ou bien l'inclusion d'un autre fichier.</p>
	           	<pre>&lt;%@ include file="autre_fichier.jsp" %&gt;</pre>
	        </section>
	        <p class="source">http://fr.wikipedia.org/wiki/JavaServer_Pages</p>
	      </div>
	      
	      <div class="slide">
	      	<header>Les actions jsp</header>
	        <section>
	        	<p>Les actions JSP sont des balises qui appellent des fonctions sur serveur HTTP</p>
	        	<p>Le format d'une action est le suivant.</p>
	        	<pre>&lt;jsp:action { attribut="valeur" } /&gt;</pre>
	        	<p>Par exemple, un include s'écrit comme suit.</p>
	        	<pre>
&lt;jsp:include page="autre_fichier.jsp" &gt;
   &lt;jsp:param name="monParam" value="valeur" /&gt;
&lt;/jsp:include&gt;</pre>
				<p>En pratique, les actions sont peu utilisées car il existe des mécanismes plus puissants.</p>
	        </section>
	        <p class="source">http://fr.wikipedia.org/wiki/JavaServer_Pages</p>
	      </div>
	      
	      <div class="slide">
	      	<header>Variables implicites</header>
	        <section>
	        	<p>Les variables implicites sont des variables qui sont présentes dans toutes les jsp.</p>
	        	<p>En voici quelques unes</p>
	        	<ul>
	        		<li><b>out</b> : le JSPWriter utilisé pour envoyer la réponse HTTP au client
	        		<li><b>page</b> : la Servlet elle même
	        		<li><b>pageContext</b> : les données associées à la page entière
	        		<li><b>request</b> : la requête
	        		<li><b>response</b> : la réponse
	        		<li><b>session</b> : la session
	        		<li><b>cookie</b> : les cookies
	        		<li><b>header</b> : tous les headers
	        		<li><b>param</b> : tous paramètres
	        	</ul>
	        	<p>Il est rare d'avoir recours à ces variable car, soit leur usage relève davantage du rôle de la servlet, soit il est existe de meilleurs façons de faire.</p>
	        </section>
	        <p class="source">http://java.sun.com/developer/technicalArticles/javaserverpages/JSP20/</p>
	      </div>
	      
	      <div class="slide">
	      	<header>Expression language</header>
	        <section>
	        	<p>C'est une notation simple et puissante utilisable partout dans les jsp.</p>
	        	<pre>${expression}</pre>
	        	<p>Elle permet d'aller chercher des valeurs en parcourant tous les scopes (page, request, session et application) et d'effectuer des opérations.</p>
	         	<p>L'expression suivante</p>
	         	<pre>${cart.items[2].name}</pre>
	         	<p>Synthétise un appel qui pourrait être écrit comme suit</p>
	         	<pre>Cart cart = (Cart) request.getSession().getAttribute("cart");
	         	
String name = cart.getItems().get(2).getName();

response.getWriter().write(name);</pre>
	        </section>
	        <p class="source">http://download.oracle.com/javaee/1.4/tutorial/doc/JSPIntro7.html</p>
	      </div>
	      
	      <div class="slide">
	      	<header>Custom tags et fonctions</header>
	        <section>
	        	<p>Un custom tag est un nouvel élément du language que l'on peut soi même définir.</p>
	        	<p>Afin de pouvoir l'utiliser, il suffit d'utiliser la directive taglib suivante.</p>
	        	<pre>&lt;%@ taglib uri="/WEB-INF/tld/mataglib.tld" prefix="mataglib" %&gt;</pre>
	        	<p>Une taglib peut contenir des tags et des fonctions.</p>
	        	<p>Les tags, selon le besoin, peuvent être implémentés par des classes java ou bien des fichiers tag.</p>
	        	<p>Voici un exemple d'appel à un tag.</p>
	        	<pre>&lt;mataglib:faituntruc att1="valeur1" att2="valeur2" &gt;</pre>
	        	<p>Et une fonction.</p>
	        	<pre>${mataglib:faitca("valeur1")}</pre>
	        </section>
	      </div>
	      
	      <div class="slide">
	      	<header>Jstl</header>
	        <section>
	        	<p>La java standard tag library est la librairie de tag la plus utilisée.</p>
	        	<p>Elle contient 4 taglibs et un ensemble de fonctions:</p>
	        	<ul>
	        		<li>&lt;c:/&gt; : la taglib essentielle avec le contrôle de flot
	        	</ul>
	        	<pre>&lt;c:if test="${empty param['name']}"&gt;Nom inconnu&lt;/c:if&gt;</pre>
				<ul>
	        		<li>&lt;fmt:/&gt; : le fomattage
	        	</ul>
	        	<pre>&lt;fmt:formatDate value="${date}" pattern="dd/MM/yyyy"/c:if&gt;</pre>
	        	<ul>
	        		<li>&lt;sql:/&gt; : l'accès aux bases de données
	        		<li>&lt;x:/&gt; : le parsing xml
	        		<li>${fn:} : la manipulation de chaînes de charactères
	        	</ul>
	        	<pre>${fn:escapeXml("les &lt;balises&gt; xml &amp; html")}
retournera "les &amp;lt;balises&amp;gt; xml &amp;amp; html"</pre>
	        </section>
	        <p class="source">http://adiguba.developpez.com/tutoriels/j2ee/jsp/jstl/</p>
	      </div>
	     
	  </div>
      <!-- slides -->

    </div> <!-- presentation -->
    
  	</body>
</html>